"""
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–æ—Ç–∞.
"""
import os
import logging
from dotenv import load_dotenv

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ .env —Ñ–∞–π–ª–∞
env_loaded = load_dotenv()
if env_loaded:
    logger.info("‚úÖ .env —Ñ–∞–π–ª –Ω–∞–π–¥–µ–Ω –∏ –∑–∞–≥—Ä—É–∂–µ–Ω")
else:
    logger.warning(
        "‚ö†Ô∏è .env —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è")

# –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞
# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
env_bot_token = os.environ.get("BOT_TOKEN")
if env_bot_token:
    env_masked = env_bot_token[:8] + "..." + \
        env_bot_token[-6:] if len(env_bot_token) > 10 else "***—Å–∫—Ä—ã—Ç***"
    logger.info(f"üîç –í —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–∞–π–¥–µ–Ω BOT_TOKEN: {env_masked}")

BOT_TOKEN = os.getenv("BOT_TOKEN")
if not BOT_TOKEN:
    logger.error("‚ùå –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è!")
    raise ValueError("–ù–µ –∑–∞–¥–∞–Ω —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è")

# –õ–æ–≥–∏—Ä—É–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–∫–µ–Ω–µ (–º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–Ω—É—é –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
if len(BOT_TOKEN) > 10:
    masked_token = BOT_TOKEN[:8] + "..." + BOT_TOKEN[-6:]
else:
    masked_token = "***—Å–∫—Ä—ã—Ç***"

logger.info(f"üîë –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –∑–∞–≥—Ä—É–∂–µ–Ω: {masked_token}")
logger.info(
    f"üìç –ò—Å—Ç–æ—á–Ω–∏–∫ —Ç–æ–∫–µ–Ω–∞: {'—Ñ–∞–π–ª .env' if env_loaded else '—Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è'}")

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ñ–æ—Ä–º–∞—Ç–∞ .env —Ñ–∞–π–ª–∞
if env_loaded:
    try:
        with open('.env', 'r', encoding='utf-8') as f:
            env_content = f.read()
        if 'BOT_TOKEN =' in env_content:
            logger.warning(
                "‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –í .env —Ñ–∞–π–ª–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å –ø—Ä–æ–±–µ–ª–∞–º–∏!")
            logger.warning(
                "‚ö†Ô∏è –ò–∑–º–µ–Ω–∏—Ç–µ 'BOT_TOKEN = \"—Ç–æ–∫–µ–Ω\"' –Ω–∞ 'BOT_TOKEN=—Ç–æ–∫–µ–Ω' (–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤ –∏ –∫–∞–≤—ã—á–µ–∫)")
        elif 'BOT_TOKEN=' in env_content:
            logger.info("‚úÖ –§–æ—Ä–º–∞—Ç .env —Ñ–∞–π–ª–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π")
    except Exception as e:
        logger.warning(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç .env —Ñ–∞–π–ª–∞: {e}")

# –ü—É—Ç–∏ –∫ –¥–∞–Ω–Ω—ã–º
DATA_PATH = "./data"
EXCEL_FILES = {
    "books": "./file.xlsx",
    "reading_plan": "./plan.xlsx"
}

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ API
API_URL = "https://justbible.ru/api"
API_TIMEOUT = 10  # —Å–µ–∫—É–Ω–¥—ã

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ë–∏–±–ª–∏–∏
# True - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ JSON —Ñ–∞–π–ª—ã, False - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API
USE_LOCAL_FILES = True
LOCAL_FILES_PATH = "./local"  # –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ JSON —Ñ–∞–π–ª–∞–º–∏

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π Telegram
MESS_MAX_LENGTH = 4096  # –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è

# –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã –ë–∏–±–ª–∏–∏
AVAILABLE_TRANSLATIONS = {
    "rst": "–°–∏–Ω–æ–¥–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥",
    "rbo": "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ –†–ë–û"
}

# –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
CACHE_TTL = 3600  # –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫—ç—à–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ—É–Ω–∫—Ü–∏–π
ENABLE_WORD_SEARCH = False  # –í–∫–ª—é—á–∏—Ç—å/–æ—Ç–∫–ª—é—á–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø–æ–∏—Å–∫–∞ –ø–æ —Å–ª–æ–≤—É
ENABLE_VERSE_NUMBERS = True  # –í–∫–ª—é—á–∏—Ç—å/–æ—Ç–∫–ª—é—á–∏—Ç—å –≤—ã–≤–æ–¥ —Å –Ω–æ–º–µ—Ä–∞–º–∏ —Å—Ç–∏—Ö–æ–≤
# –í–∫–ª—é—á–∏—Ç—å/–æ—Ç–∫–ª—é—á–∏—Ç—å —Ç–æ–ª–∫–æ–≤–∞–Ω–∏—è –õ–æ–ø—É—Ö–∏–Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ
ENABLE_LOPUKHIN_COMMENTARY = False

# –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
LOG_LEVEL = os.getenv("LOG_LEVEL", "INFO")
LOG_FORMAT = "%(asctime)s - %(name)s - %(levelname)s - %(message)s"

# –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
ENABLE_DELETE_RELATED_MESSAGES_DEFAULT = False

# --- –ù–ê–°–¢–†–û–ô–ö–ò –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–Ø ---

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –ë–∏–±–ª–∏–∏ —Å –Ω–æ–º–µ—Ä–∞–º–∏ —Å—Ç–∏—Ö–æ–≤
BIBLE_MARKDOWN_ENABLED = False  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Markdown –¥–ª—è —Ç–µ–∫—Å—Ç–∞ –ë–∏–±–ª–∏–∏
BIBLE_MARKDOWN_MODE = "HTML"  # HTML, Markdown, MarkdownV2
# –í—ã–≤–æ–¥–∏—Ç—å –±–∏–±–ª–µ–π—Å–∫–∏–π —Ç–µ–∫—Å—Ç –∫–∞–∫ —Ü–∏—Ç–∞—Ç—É (blockquote)
BIBLE_QUOTE_ENABLED = False
# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±–µ–ª–æ–≤ –ø–æ—Å–ª–µ –Ω–æ–º–µ—Ä–∞ —Å—Ç–∏—Ö–∞ (1, 2, 3 –∏ —Ç.–¥.)
BIBLE_VERSE_NUMBER_SPACING = 2
# –í–∫–ª—é—á–∞—Ç—å –Ω–æ–º–µ—Ä –≥–ª–∞–≤—ã –ø–µ—Ä–µ–¥ –Ω–æ–º–µ—Ä–æ–º —Å—Ç–∏—Ö–∞ (2:12 –≤–º–µ—Å—Ç–æ 12)
BIBLE_INCLUDE_CHAPTER_NUMBER = True
# –°—Ç–∏–ª—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–º–µ—Ä–æ–≤ —Å—Ç–∏—Ö–æ–≤: bold, code, italic
BIBLE_VERSE_NUMBER_STYLE = "code"

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª–∫–æ–≤–∞–Ω–∏–π –∏ –ò–ò-–æ—Ç–≤–µ—Ç–æ–≤
COMMENTARY_MARKDOWN_ENABLED = True  # –í–∫–ª—é—á–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Ç–æ–ª–∫–æ–≤–∞–Ω–∏–π –∏ –ò–ò
COMMENTARY_MARKDOWN_MODE = "HTML"  # –†–µ–∂–∏–º: HTML, Markdown, MarkdownV2

# –û—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
MARKDOWN_ENABLED = True  # –í–∫–ª—é—á–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ MarkdownV2 –¥–ª—è —Ç–æ–ª–∫–æ–≤–∞–Ω–∏–π –∏ –ò–ò
MARKDOWN_MODE = "MarkdownV2"  # –†–µ–∂–∏–º: Markdown, MarkdownV2, HTML
MARKDOWN_BOLD_TITLE = True  # –î–µ–ª–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∂–∏—Ä–Ω—ã–º–∏
MARKDOWN_QUOTE = True  # –í—ã–≤–æ–¥–∏—Ç—å —Ç–µ–∫—Å—Ç –∫–∞–∫ —Ü–∏—Ç–∞—Ç—É (blockquote)
MARKDOWN_ESCAPE = True  # –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã –¥–ª—è MarkdownV2
