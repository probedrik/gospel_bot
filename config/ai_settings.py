# Настройки ИИ-функций для бота
import os

ENABLE_GPT_EXPLAIN = True  # Включить/отключить кнопку и функцию "Объяснить смысл с ИИ"

# === ОБЫЧНЫЙ ИИ (бесплатные лимиты) ===
OPENROUTER_API_KEY = os.getenv("OPENROUTER_API_KEY", "")
OPENROUTER_MODEL = "mistralai/mistral-small-3.1-24b-instruct:free"

# Роль для обычного ИИ
LLM_ROLE = (
    "Вы — православный богослов и лингвист. "
    "Ваша задача — кратко, понятно и уважительно объяснить смысл указанной главы или стиха Библии. "
    "Давайте исторический, богословский и языковой контекст, избегайте субъективных оценок и споров. "
    "Объяснение должно быть полезно для современного читателя, но не заменять толкования святых отцов. "
    "ТРЕБОВАНИЯ К ОТВЕТУ: "
    "Напишите краткий анализ объемом 500-700 символов."
    "Будьте лаконичны, но информативны. "
    "Пишите ТОЛЬКО на русском языке! "
    "Не используйте иероглифы, латинские буквы или другие иностранные символы. "
    "Все термины и имена должны быть написаны русскими буквами."
)

# === ПРЕМИУМ ИИ (платные запросы) ===
OPENROUTER_PREMIUM_API_KEY = os.getenv("OPENROUTER_PREMIUM_API_KEY", "")
OPENROUTER_PREMIUM_MODEL = os.getenv(
    "OPENROUTER_PREMIUM_MODEL", "google/gemini-2.5-flash-lite")

# Роль для премиум ИИ - более подробная и экспертная
LLM_PREMIUM_ROLE = (
    "Вы — выдающийся православный богослов, библеист и лингвист, "
    "знаток церковной истории и святоотеческого наследия. "
    "Ваша задача — дать исчерпывающий, но доступный анализ указанной главы или стиха Библии. "
    "Включите в ответ: исторический контекст, богословское значение, связи с другими местами Писания, "
    "толкования святых отцов (если уместно), практическое применение для современной духовной жизни. "
    "Ответ должен быть глубоким, но понятным для образованного верующего. "
    "Избегайте спорных интерпретаций, придерживайтесь православной традиции. "
    "ТРЕБОВАНИЯ К ОТВЕТУ: "
    "Напишите анализ объемом 1000-1200 символов. "
    "Структурируйте ответ с заголовками и подразделами для лучшей читаемости. "
    "Пишите ТОЛЬКО на русском языке! "
    "Никогда не используйте иероглифы, латинские буквы, болгарские или другие иностранные символы. "
    "Если нужно привести оригинальное слово - используйте только русскую транскрипцию. "
    "Все имена, термины и цитаты должны быть написаны русскими буквами."
)

# === ЛИМИТЫ СИМВОЛОВ ===
# Максимальная длина сообщения в Telegram: 4096 символов
TELEGRAM_MAX_MESSAGE_LENGTH = 4096

# Лимит символов для обычного ИИ (половина от максимума)
AI_REGULAR_MAX_CHARS = TELEGRAM_MAX_MESSAGE_LENGTH // 2  # 2048 символов

# Лимит символов для премиум ИИ (увеличенный для подробных разборов)
# Telegram позволяет до 4096 символов на сообщение, но мы можем разбивать на части
# 8000 символов (будет разбито на части при отправке)
AI_PREMIUM_MAX_CHARS = 8000

# === ЛИМИТЫ И ИСКЛЮЧЕНИЯ ДЛЯ ИИ ===
AI_OWNER_ID = 2040516595  # ID владельца, всегда безлимит
# Множество ID с безлимитным доступом (можно редактировать)
AI_UNLIMITED_USERS = {AI_OWNER_ID}
AI_DAILY_LIMIT = 3  # Лимит ИИ-запросов в сутки на пользователя

# Пользователи с бесплатным доступом к премиум ИИ (можно редактировать через админ панель)
AI_FREE_PREMIUM_USERS = set()  # Пример: {123456789, 987654321}

# === НАСТРОЙКИ ПЛАТЕЖЕЙ ===
# ЮKassa настройки (из .env файла)
YOOKASSA_SHOP_ID = os.getenv("YOOKASSA_SHOP_ID", "")
YOOKASSA_SECRET_KEY = os.getenv("YOOKASSA_SECRET_KEY", "")
YOOKASSA_WEBHOOK_SECRET = os.getenv("YOOKASSA_WEBHOOK_SECRET", "")

# Цены (в рублях)
PREMIUM_AI_PACKAGE_PRICE = 100  # 100₽ за 50 запросов
PREMIUM_AI_PACKAGE_REQUESTS = 30

# Включить подробное логирование ответов OpenRouter API (для отладки)
LOG_OPENROUTER_RESPONSE = False

# Настройки max_tokens для OpenRouter API
DEFAULT_MAX_TOKENS = 500  # Для обычных пользователей
PREMIUM_MAX_TOKENS_SHORT = 500  # Краткий разбор для премиум пользователей
PREMIUM_MAX_TOKENS_FULL = 1200  # Полный разбор для премиум пользователей

# Типы разбора для премиум пользователей
RESPONSE_LENGTH_SHORT = "short"  # Краткий
RESPONSE_LENGTH_FULL = "full"    # Полный
