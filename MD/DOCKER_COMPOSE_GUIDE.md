# ðŸ³ Ð—Ð°Ð¿ÑƒÑÐº Gospel Bot Ñ‡ÐµÑ€ÐµÐ· Docker Compose

## ðŸš€ Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ ÑÑ‚Ð°Ñ€Ñ‚

### 1. ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ñ„Ð°Ð¹Ð»Ð¾Ð²

Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾ Ñƒ Ð²Ð°Ñ ÐµÑÑ‚ÑŒ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ Ñ„Ð°Ð¹Ð»Ñ‹:
- `docker-compose.yml` âœ…
- `.env` (ÑÐ¾Ð·Ð´Ð°Ð´Ð¸Ð¼ Ð½Ð¸Ð¶Ðµ)

### 2. Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ .env Ñ„Ð°Ð¹Ð»Ð°

```bash
# Ð¡ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð¿Ñ€Ð¸Ð¼ÐµÑ€ Ð¸ Ð¾Ñ‚Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ
cp env.docker.example .env
```

Ð˜Ð»Ð¸ ÑÐ¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ `.env` Ñ„Ð°Ð¹Ð» Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ:

```bash
# Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ .env Ñ„Ð°Ð¹Ð»
cat > .env << EOF
# ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ (ÐžÐ‘Ð¯Ð—ÐÐ¢Ð•Ð›Ð¬ÐÐ«Ð•)
BOT_TOKEN=Ð²Ð°Ñˆ_Ñ‚Ð¾ÐºÐµÐ½_Ð±Ð¾Ñ‚Ð°_Ð·Ð´ÐµÑÑŒ
ADMIN_USER_ID=Ð²Ð°Ñˆ_telegram_id

# Ð˜Ð˜ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ (ÐžÐŸÐ¦Ð˜ÐžÐÐÐ›Ð¬ÐÐž)
OPENROUTER_API_KEY=Ð²Ð°Ñˆ_Ð½Ð¾Ð²Ñ‹Ð¹_openrouter_Ñ‚Ð¾ÐºÐµÐ½

# Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸
TZ=Europe/Moscow
LOG_LEVEL=INFO
EOF
```

### 3. ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ñ‚Ð¾ÐºÐµÐ½Ð¾Ð²

#### Telegram Bot Token
1. ÐÐ°Ð¿Ð¸ÑˆÐ¸Ñ‚Ðµ @BotFather Ð² Telegram
2. Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð±Ð¾Ñ‚Ð°: `/newbot`
3. Ð¡ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ñ‚Ð¾ÐºÐµÐ½

#### Ð’Ð°Ñˆ Telegram ID
1. ÐÐ°Ð¿Ð¸ÑˆÐ¸Ñ‚Ðµ @userinfobot Ð² Telegram
2. Ð¡ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð²Ð°Ñˆ ID

#### OpenRouter API Key (Ð´Ð»Ñ Ð˜Ð˜ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹)
1. Ð—Ð°Ð¹Ð´Ð¸Ñ‚Ðµ Ð½Ð° https://openrouter.ai/
2. Ð—Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€ÑƒÐ¹Ñ‚ÐµÑÑŒ/Ð²Ð¾Ð¹Ð´Ð¸Ñ‚Ðµ
3. Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð½Ð¾Ð²Ñ‹Ð¹ API ÐºÐ»ÑŽÑ‡
4. Ð¡ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ ÐºÐ»ÑŽÑ‡

### 4. Ð—Ð°Ð¿ÑƒÑÐº Ð±Ð¾Ñ‚Ð°

```bash
# Ð—Ð°Ð¿ÑƒÑÐº Ð² Ñ„Ð¾Ð½Ð¾Ð²Ð¾Ð¼ Ñ€ÐµÐ¶Ð¸Ð¼Ðµ
docker compose up -d

# Ð˜Ð»Ð¸ Ð·Ð°Ð¿ÑƒÑÐº Ñ Ð²Ñ‹Ð²Ð¾Ð´Ð¾Ð¼ Ð»Ð¾Ð³Ð¾Ð²
docker compose up
```

## ðŸ“‹ Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð±Ð¾Ñ‚Ð¾Ð¼

### ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹

```bash
# Ð—Ð°Ð¿ÑƒÑÐº
docker compose up -d

# ÐžÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ°
docker compose down

# ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº
docker compose restart

# ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð»Ð¾Ð³Ð¾Ð²
docker compose logs bible-bot

# Ð›Ð¾Ð³Ð¸ Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
docker compose logs -f bible-bot

# Ð¡Ñ‚Ð°Ñ‚ÑƒÑ ÑÐµÑ€Ð²Ð¸ÑÐ¾Ð²
docker compose ps

# ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¾Ð±Ñ€Ð°Ð·Ð°
docker compose pull
docker compose up -d
```

### ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ

```bash
# Ð¡Ñ‚Ð°Ñ‚ÑƒÑ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð°
docker compose ps

# Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ€ÐµÑÑƒÑ€ÑÐ¾Ð²
docker stats bible-bot

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÑ
docker inspect --format='{{.State.Health.Status}}' bible-bot
```

## ðŸ”§ ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¸ Ð¾Ñ‚Ð»Ð°Ð´ÐºÐ°

### ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸

```bash
# ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð¸Ñ‚Ð¾Ð³Ð¾Ð²ÑƒÑŽ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸ÑŽ
docker compose config

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ
docker compose exec bible-bot env | grep -E "(BOT_TOKEN|ADMIN_USER_ID|OPENROUTER)"
```

### ÐžÑ‚Ð»Ð°Ð´ÐºÐ°

```bash
# ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒÑÑ Ðº ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ñƒ
docker compose exec bible-bot bash

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð»Ð¾Ð³Ð¸ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ
docker compose exec bible-bot cat logs/bot.log

# ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº Ñ Ð¿ÐµÑ€ÐµÑÐ±Ð¾Ñ€ÐºÐ¾Ð¹ (ÐµÑÐ»Ð¸ Ð½ÑƒÐ¶Ð½Ð¾)
docker compose up -d --force-recreate
```

### ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ð¸ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ

#### Ð‘Ð¾Ñ‚ Ð½Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ
```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð»Ð¾Ð³Ð¸
docker compose logs bible-bot

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ
docker compose exec bible-bot env | grep BOT_TOKEN
```

#### ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ñ Ð¿Ñ€Ð°Ð²Ð°Ð¼Ð¸ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°
```bash
# Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ð¸ Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¼Ð¸ Ð¿Ñ€Ð°Ð²Ð°Ð¼Ð¸
mkdir -p data logs
chmod 755 data logs
```

#### ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¾Ð±Ñ€Ð°Ð·Ð°
```bash
# ÐžÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Ð±Ð¾Ñ‚Ð°
docker compose down

# Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚Ðµ Ð½Ð¾Ð²ÑƒÑŽ Ð²ÐµÑ€ÑÐ¸ÑŽ
docker compose pull

# Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð½ÑƒÑŽ Ð²ÐµÑ€ÑÐ¸ÑŽ
docker compose up -d
```

## ðŸ“Š ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³

### Ð›Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

Ð›Ð¾Ð³Ð¸ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ñ€Ð¾Ñ‚Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ:
- ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ€Ð°Ð·Ð¼ÐµÑ€ Ñ„Ð°Ð¹Ð»Ð°: 10MB
- ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ñ„Ð°Ð¹Ð»Ð¾Ð²: 3
- Ð›Ð¾Ð³Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÑŽÑ‚ÑÑ Ð² `./logs/`

### Health Check

Ð’ÑÑ‚Ñ€Ð¾ÐµÐ½Ð½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÑ:
- Ð˜Ð½Ñ‚ÐµÑ€Ð²Ð°Ð»: 30 ÑÐµÐºÑƒÐ½Ð´
- Ð¢Ð°Ð¹Ð¼Ð°ÑƒÑ‚: 10 ÑÐµÐºÑƒÐ½Ð´
- ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ñ‹: 3
- Ð’Ñ€ÐµÐ¼Ñ Ð·Ð°Ð¿ÑƒÑÐºÐ°: 40 ÑÐµÐºÑƒÐ½Ð´

```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÑ
docker compose exec bible-bot python -c "import asyncio; print('Bot is healthy')"
```

## ðŸ”’ Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ

### ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ

**ÐÐ˜ÐšÐžÐ“Ð”Ð Ð½Ðµ Ð²ÐºÐ»ÑŽÑ‡Ð°Ð¹Ñ‚Ðµ ÑÐµÐºÑ€ÐµÑ‚Ñ‹ Ð² docker-compose.yml!**

âœ… **ÐŸÑ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾** (Ñ‡ÐµÑ€ÐµÐ· .env Ñ„Ð°Ð¹Ð»):
```yaml
env_file:
  - .env
```

âŒ **ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾** (ÑÐµÐºÑ€ÐµÑ‚Ñ‹ Ð² ÐºÐ¾Ð´Ðµ):
```yaml
environment:
  - BOT_TOKEN=1234567890:ABC...  # ÐÐ• Ð”Ð•Ð›ÐÐ™Ð¢Ð• Ð¢ÐÐš!
```

### Ð¤Ð°Ð¹Ð» .env

Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾ `.env` Ñ„Ð°Ð¹Ð»:
- ÐÐµ Ð¿Ð¾Ð¿Ð°Ð´Ð°ÐµÑ‚ Ð² Git (Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ Ð² `.gitignore`)
- Ð˜Ð¼ÐµÐµÑ‚ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°: `chmod 600 .env`
- Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ð°ÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ñ‚Ð¾ÐºÐµÐ½Ñ‹

## ðŸ“ Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ñ„Ð°Ð¹Ð»Ð¾Ð²

```
gospel/
â”œâ”€â”€ docker-compose.yml          # ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ Docker Compose
â”œâ”€â”€ .env                        # ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ (ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ)
â”œâ”€â”€ env.docker.example          # ÐŸÑ€Ð¸Ð¼ÐµÑ€ .env Ñ„Ð°Ð¹Ð»Ð°
â”œâ”€â”€ data/                       # Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ… (ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ÑÑ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸)
â”œâ”€â”€ logs/                       # Ð›Ð¾Ð³Ð¸ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ (ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ÑÑ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸)
â””â”€â”€ DOCKER_COMPOSE_GUIDE.md     # Ð­Ñ‚Ð° Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ñ
```

## ðŸŽ¯ ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ

### Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ°

```bash
# Ð—Ð°Ð¿ÑƒÑÐº Ñ Ð²Ñ‹Ð²Ð¾Ð´Ð¾Ð¼ Ð»Ð¾Ð³Ð¾Ð² Ð´Ð»Ñ Ð¾Ñ‚Ð»Ð°Ð´ÐºÐ¸
docker compose up

# Ð’ Ð´Ñ€ÑƒÐ³Ð¾Ð¼ Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð»Ðµ - Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð»Ð¾Ð³Ð¾Ð²
docker compose logs -f bible-bot
```

### ÐŸÑ€Ð¾Ð´Ð°ÐºÑˆÐ½

```bash
# Ð—Ð°Ð¿ÑƒÑÐº Ð² Ñ„Ð¾Ð½Ð¾Ð²Ð¾Ð¼ Ñ€ÐµÐ¶Ð¸Ð¼Ðµ
docker compose up -d

# ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð°Ð²Ñ‚Ð¾Ð·Ð°Ð¿ÑƒÑÐºÐ° (systemd)
sudo systemctl enable docker
```

### ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ

```bash
# ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð´Ð¾ Ð½Ð¾Ð²Ð¾Ð¹ Ð²ÐµÑ€ÑÐ¸Ð¸
docker compose down
docker compose pull
docker compose up -d

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ°, Ñ‡Ñ‚Ð¾ Ð²ÑÐµ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚
docker compose ps
docker compose logs bible-bot
```

## ðŸ”— ÐŸÐ¾Ð»ÐµÐ·Ð½Ñ‹Ðµ ÑÑÑ‹Ð»ÐºÐ¸

- ðŸ“– [ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ](README.md)
- ðŸ³ [Docker Hub Ð¾Ð±Ñ€Ð°Ð·](https://hub.docker.com/r/probedrik/gospel-bot)
- ðŸ“‹ [ÐŸÐ¾Ð»Ð½Ð°Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ð¿Ð¾ Docker](DOCKER_DEPLOYMENT.md)
- ðŸš€ [ÐšÑ€Ð°Ñ‚ÐºÐ°Ñ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ñ](DOCKER_USAGE.md)

---

**ðŸŽ‰ Ð“Ð¾Ñ‚Ð¾Ð²Ð¾! Ð’Ð°Ñˆ Gospel Bot Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ñ‡ÐµÑ€ÐµÐ· Docker Compose!** 