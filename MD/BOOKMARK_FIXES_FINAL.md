# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ö–ù–û–ü–û–ö –ó–ê–ö–õ–ê–î–û–ö –ó–ê–í–ï–†–®–ï–ù–´

## üéØ –ü—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã

### 1. ‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∑–∞–∫–ª–∞–¥–∫–∏"
**–ë—ã–ª–æ**: –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç–∏—Ö–∞ –ø–æ—è–≤–ª—è–ª–æ—Å—å 2 –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏ –∑–∞–∫–ª–∞–¥–∫–∏
**–°—Ç–∞–ª–æ**: ‚úÖ –¢–æ–ª—å–∫–æ –æ–¥–Ω–∞ –∫–Ω–æ–ø–∫–∞ –∑–∞–∫–ª–∞–¥–∫–∏

### 2. ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∏—Ö–æ–≤  
**–ë—ã–ª–æ**: –ü—Ä–∏ –≤–≤–æ–¥–µ `–ü—Å 22:4` —Å–æ—Ö—Ä–∞–Ω—è–ª–∞—Å—å –≤—Å—è –≥–ª–∞–≤–∞ 22
**–°—Ç–∞–ª–æ**: ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å—Ç–∏—Ö 4

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### handlers/text_messages.py - —Ñ—É–Ω–∫—Ü–∏—è verse_reference()

**–£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```python
# ‚ùå –ë–´–õ–û - —Ä—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –¥–ª—è —Å—Ç–∏—Ö–æ–≤
if book_id and verse:
    bookmark_button = create_bookmark_button(...)
    buttons.append([bookmark_button])

# ‚úÖ –°–¢–ê–õ–û - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –µ–¥–∏–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
from utils.bible_data import create_chapter_action_buttons
extra_buttons = await create_chapter_action_buttons(
    book_id, chapter, en_book, user_id=message.from_user.id,
    verse_start=verse_start, verse_end=verse_end  # ‚Üê –î–æ–±–∞–≤–ª–µ–Ω–æ!
)
```

### utils/bible_data.py - —Ñ—É–Ω–∫—Ü–∏—è create_chapter_action_buttons()

**–û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å–∏–≥–Ω–∞—Ç—É—Ä–∞:**
```python
# ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Å—Ç–∏—Ö–æ–≤
async def create_chapter_action_buttons(
    book_id, chapter, en_book=None, exclude_ai=False, user_id=None, 
    verse_start=None, verse_end=None  # ‚Üê –ù–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
):
```

**–û–±–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∑–∞–∫–ª–∞–¥–æ–∫:**
```python
# ‚úÖ –¢–µ–ø–µ—Ä—å —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å—Ç–∏—Ö–∏
is_bookmarked = await check_if_bookmarked(
    user_id, book_id, chapter, 
    verse_start=verse_start, verse_end=verse_end  # ‚Üê –£—á–µ—Ç —Å—Ç–∏—Ö–æ–≤
)

bookmark_button = create_bookmark_button(
    book_id=book_id,
    chapter_start=chapter, 
    verse_start=verse_start,  # ‚Üê –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å—Ç–∏—Ö
    verse_end=verse_end if verse_end else verse_start
)
```

**–û–±–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Ç–æ–ª–∫–æ–≤–∞–Ω–∏–π:**
```python
# ‚úÖ –¢–æ–ª–∫–æ–≤–∞–Ω–∏—è —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Å—Ç–∏—Ö—É
verse_for_commentary = verse_start if verse_start else 0

saved_ai_commentary = await universal_db_manager.get_saved_commentary(
    user_id, book_id, chapter, chapter, 
    verse_for_commentary, verse_for_commentary, "ai"  # ‚Üê –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å—Ç–∏—Ö
)
```

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

| –í–≤–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –ß—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è | –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –∑–∞–∫–ª–∞–¥–∫–∞—Ö |
|-------------------|-----------------|-------------------------|
| `–ü—Å 22:4` | –ü—Å–∞–ª–æ–º 22, —Å—Ç–∏—Ö 4 | "–ü—Å–∞–ª–æ–º 22:4" |
| `–ú—Ñ 5:3-12` | –ú–∞—Ç—Ñ–µ—è 5, —Å—Ç–∏—Ö–∏ 3-12 | "–ú–∞—Ç—Ñ–µ—è 5:3-12" |
| `–ë—ã—Ç 1` | –ë—ã—Ç–∏–µ 1, –≤—Å—è –≥–ª–∞–≤–∞ | "–ë—ã—Ç–∏–µ 1" |
| `–ò–Ω 3:16` | –ò–æ–∞–Ω–Ω–∞ 3, —Å—Ç–∏—Ö 16 | "–ò–æ–∞–Ω–Ω–∞ 3:16" |

## üéÆ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ:

1. **–ï–¥–∏–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –∑–∞–∫–ª–∞–¥–∫–∏** - –Ω–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
2. **–¢–æ—á–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∏—Ö–æ–≤** - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏–º–µ–Ω–Ω–æ —Ç–æ, —á—Ç–æ –∑–∞–ø—Ä–æ—Å–∏–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
3. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã** - `–ú—Ñ 5:3-12` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ –¥–∏–∞–ø–∞–∑–æ–Ω
4. **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–æ–ª–∫–æ–≤–∞–Ω–∏—è** - –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Å—Ç–∏—Ö—É
5. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–∫–ª–∞–¥–æ–∫** - —É—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–æ—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### üîÑ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Å—Å—ã–ª–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, `–ü—Å 22:4`)
2. –ü–∞—Ä—Å–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: –∫–Ω–∏–≥–∞=–ü—Å–∞–ª–æ–º, –≥–ª–∞–≤–∞=22, —Å—Ç–∏—Ö=4
3. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `create_chapter_action_buttons()` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Å—Ç–∏—Ö–∞
4. –°–æ–∑–¥–∞–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ –∑–∞–∫–ª–∞–¥–∫–∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
5. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å—Ç–∏—Ö 4, –∞ –Ω–µ –≤—Å—è –≥–ª–∞–≤–∞

## üìÅ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### handlers/text_messages.py
- ‚úÖ –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –∑–∞–∫–ª–∞–¥–∫–∏ –≤ `verse_reference()`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä—Å–∏–Ω–≥ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ —Å—Ç–∏—Ö–æ–≤
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –µ–¥–∏–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ `create_chapter_action_buttons()`

### utils/bible_data.py  
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `verse_start` –∏ `verse_end`
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–æ–ø–∫–∏ –∑–∞–∫–ª–∞–¥–∫–∏
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–ª–∫–æ–≤–∞–Ω–∏–π
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã callback_data –¥–ª—è –∫–Ω–æ–ø–æ–∫

## üöÄ –°—Ç–∞—Ç—É—Å: –ì–û–¢–û–í–û ‚úÖ

–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã. –°–∏—Å—Ç–µ–º–∞ –∑–∞–∫–ª–∞–¥–æ–∫ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:

- ‚úÖ **–ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–Ω–æ–ø–æ–∫**
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∏—Ö–æ–≤**  
- ‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏**
- ‚úÖ **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–æ–ª–∫–æ–≤–∞–Ω–∏—è –¥–ª—è —Å—Ç–∏—Ö–æ–≤**

## üéØ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ç–µ–ø–µ—Ä—å –º–æ–≥—É—Ç:
- –û—Ç–∫—Ä—ã–≤–∞—Ç—å –ª—é–±—ã–µ —Å—Ç–∏—Ö–∏ –±–µ–∑ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –∫–Ω–æ–ø–æ–∫
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å —Ç–æ—á–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç–∏—Ö–∏ –≤ –∑–∞–∫–ª–∞–¥–∫–∏
- –ü–æ–ª—É—á–∞—Ç—å —Ç–æ–ª–∫–æ–≤–∞–Ω–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å—Ç–∏—Ö–æ–≤
- –†–∞–±–æ—Ç–∞—Ç—å —Å –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏ —Å—Ç–∏—Ö–æ–≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ