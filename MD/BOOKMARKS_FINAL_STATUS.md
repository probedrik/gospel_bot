# ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∑–∞–∫–ª–∞–¥–æ–∫ - —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å

## üéØ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. **–ö–Ω–æ–ø–∫–∏ –∑–∞–∫–ª–∞–¥–æ–∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã**
- ‚úÖ **–î–ª—è –≥–ª–∞–≤** - –≤ `utils/bible_data.py` (create_chapter_action_buttons)
- ‚úÖ **–î–ª—è —Å—Ç–∏—Ö–æ–≤ –≤ –ò–ò –ø–æ–º–æ—â–Ω–∏–∫–µ** - –≤ `handlers/ai_assistant.py` (create_ai_verse_buttons)
- ‚úÖ **–î–ª—è —Å—Ç–∏—Ö–æ–≤ –≤ —Ä–∞–∑–±–æ—Ä–µ –ò–ò** - –≤ `handlers/text_messages.py` (gpt_explain_callback)
- ‚úÖ **–î–ª—è —Å—Å—ã–ª–æ–∫ –Ω–∞ —Å—Ç–∏—Ö–∏** - –≤ `handlers/text_messages.py` (verse_reference)

### 2. **–°—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã**
- ‚úÖ **add_bookmark** –≤ `handlers/bookmark_callbacks.py` - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –ë–î
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç: `chapter_start`, `chapter_end`, `verse_start`, `verse_end`
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º —Å Supabase –∏ SQLite

### 3. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ç–æ–≤–∞**
- ‚úÖ **SQLite** - –º–∏–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- ‚úÖ **Supabase** - —Å–∫—Ä–∏–ø—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–∏ –≥–æ—Ç–æ–≤—ã
- ‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤** - –≥–ª–∞–≤ –∏ —Å—Ç–∏—Ö–æ–≤

## üöÄ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

### –ö–Ω–æ–ø–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –¥–ª—è:
1. **–û–¥–∏–Ω–æ—á–Ω–∞—è –≥–ª–∞–≤–∞**: "–ë—ã—Ç–∏–µ 1" ‚Üí `bookmark_add_1_1_0_0_0`
2. **–î–∏–∞–ø–∞–∑–æ–Ω –≥–ª–∞–≤**: "–ë—ã—Ç–∏–µ 1-3" ‚Üí `bookmark_add_1_1_3_0_0`
3. **–û–¥–∏–Ω–æ—á–Ω—ã–π —Å—Ç–∏—Ö**: "–ò–æ–∞–Ω–Ω 3:16" ‚Üí `bookmark_add_43_3_0_16_0`
4. **–î–∏–∞–ø–∞–∑–æ–Ω —Å—Ç–∏—Ö–æ–≤**: "–ò–æ–∞–Ω–Ω 3:16-18" ‚Üí `bookmark_add_43_3_0_16_18`

### Callback data —Ñ–æ—Ä–º–∞—Ç:
```
bookmark_{action}_{book_id}_{chapter_start}_{chapter_end}_{verse_start}_{verse_end}
```
–≥–¥–µ `0` –æ–∑–Ω–∞—á–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è.

## üìç –ì–¥–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–Ω–æ–ø–∫–∏

### ‚úÖ –ö–Ω–æ–ø–∫–∏ "üìå –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∑–∞–∫–ª–∞–¥–∫–∏" –ø–æ—è–≤–ª—è—é—Ç—Å—è:
1. **–ü—Ä–∏ —á—Ç–µ–Ω–∏–∏ –≥–ª–∞–≤** - —á–µ—Ä–µ–∑ `create_chapter_action_buttons`
2. **–í –ò–ò –ø–æ–º–æ—â–Ω–∏–∫–µ** - –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç–∏—Ö–æ–≤
3. **–í —Ä–∞–∑–±–æ—Ä–µ –ò–ò** - –¥–ª—è —Ç–æ–ª–∫—É–µ–º—ã—Ö —Å—Ç–∏—Ö–æ–≤ –∏ –≥–ª–∞–≤
4. **–ü—Ä–∏ –≤–≤–æ–¥–µ —Å—Å—ã–ª–æ–∫** - "–ò–Ω 3:16", "–ë—ã—Ç 1-3" –∏ —Ç.–¥.

### üîÑ –ö–Ω–æ–ø–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–µ–Ω—è—é—Ç—Å—è:
- **üìå –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∑–∞–∫–ª–∞–¥–∫–∏** ‚Üí **üîñ –£–¥–∞–ª–∏—Ç—å –∏–∑ –∑–∞–∫–ª–∞–¥–æ–∫**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —á–µ—Ä–µ–∑ `check_if_bookmarked`
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –ù–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã:
- `utils/bookmark_utils.py` - —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –ø–∞—Ä—Å–∏–Ω–≥ –∫–Ω–æ–ø–æ–∫
- `handlers/bookmark_handlers.py` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π
- `keyboards/bookmarks.py` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–æ—Å–º–æ—Ç—Ä–∞

### –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏:
- `handle_bookmark_action` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ
- `update_bookmark_button_in_message` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
- `check_if_bookmarked` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:
```sql
-- –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ bookmarks
CREATE TABLE bookmarks (
    id INTEGER PRIMARY KEY,
    user_id INTEGER,
    book_id INTEGER,
    chapter_start INTEGER NOT NULL,  -- –ù–∞—á–∞–ª—å–Ω–∞—è –≥–ª–∞–≤–∞
    chapter_end INTEGER,            -- –ö–æ–Ω–µ—á–Ω–∞—è –≥–ª–∞–≤–∞ (–¥–ª—è –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤)
    verse_start INTEGER,            -- –ù–∞—á–∞–ª—å–Ω—ã–π —Å—Ç–∏—Ö
    verse_end INTEGER,              -- –ö–æ–Ω–µ—á–Ω—ã–π —Å—Ç–∏—Ö (–¥–ª—è –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤)
    display_text TEXT,
    note TEXT,
    created_at TIMESTAMP
);
```

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (SQLite):
‚úÖ **–ì–æ—Ç–æ–≤–æ!** –í—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω (Supabase):
1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –∏–∑ `supabase_bookmarks_migration.sql`
2. –ò–ª–∏ —Å–ª–µ–¥—É–π—Ç–µ `QUICK_MIGRATION.md`

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å—Å—ã–ª–æ–∫
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ callback_data
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Å—ã–ª–æ–∫
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∑–∞–∫–ª–∞–¥–æ–∫

### –†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–æ–≤:
```
1. –û–¥–∏–Ω–æ—á–Ω–∞—è –≥–ª–∞–≤–∞: –ë—ã—Ç–∏–µ 1 ‚úÖ
2. –î–∏–∞–ø–∞–∑–æ–Ω –≥–ª–∞–≤: –ë—ã—Ç–∏–µ 1-3 ‚úÖ
3. –û–¥–∏–Ω–æ—á–Ω—ã–π —Å—Ç–∏—Ö: –ò–æ–∞–Ω–Ω 3:16 ‚úÖ
4. –î–∏–∞–ø–∞–∑–æ–Ω —Å—Ç–∏—Ö–æ–≤: –ò–æ–∞–Ω–Ω 3:16-18 ‚úÖ
```

## üéâ –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- –ö–Ω–æ–ø–∫–∏ –∑–∞–∫–ª–∞–¥–æ–∫ –≤–µ–∑–¥–µ –≥–¥–µ –Ω—É–∂–Ω–æ
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≥–ª–∞–≤ –∏ —Å—Ç–∏—Ö–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
- –ù–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∑–∞–∫–ª–∞–¥–æ–∫
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è (16 –∑–∞–∫–ª–∞–¥–æ–∫ –≤ 2 —Å—Ç–æ–ª–±—Ü–∞)
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Ç–∏–ø—ã (–ë–∏–±–ª–∏—è / –†–∞–∑–±–æ—Ä—ã)

### üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
1. **–ß–∏—Ç–∞–µ—Ç–µ –≥–ª–∞–≤—É/—Å—Ç–∏—Ö** ‚Üí –≤–∏–¥–∏—Ç–µ –∫–Ω–æ–ø–∫—É "üìå –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∑–∞–∫–ª–∞–¥–∫–∏"
2. **–ù–∞–∂–∏–º–∞–µ—Ç–µ** ‚Üí –∑–∞–∫–ª–∞–¥–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –∫–Ω–æ–ø–∫–∞ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ "üîñ –£–¥–∞–ª–∏—Ç—å –∏–∑ –∑–∞–∫–ª–∞–¥–æ–∫"
3. **"üìù –ú–æ–∏ –∑–∞–∫–ª–∞–¥–∫–∏"** ‚Üí –≤—ã–±–∏—Ä–∞–µ—Ç–µ —Ç–∏–ø ‚Üí –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç–µ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üéØ

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –í—ã–ø–æ–ª–Ω–µ–Ω–∞ –ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è –ë–î
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –ª–∏ –Ω–æ–≤—ã–µ —Ä–æ—É—Ç–µ—Ä—ã –≤ `bot.py`
3. –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ `check_if_bookmarked` —Ñ—É–Ω–∫—Ü–∏—è